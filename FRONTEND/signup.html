<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./signup.css">
    <title>Document</title>
</head>

<body>
    <div class="allheresignup">
        <div class="login-box">
            <p>Sign Up</p>
            <form>
                <span id="alertempty"></span><br>
                <div class="user-box">
                    <input id="Username" required="" name="" type="text">
                    <label>Username</label>
                </div>
                <div class="user-box">
                    <input id="email" required="" name="" type="text">
                    <label>Email</label>
                </div>
                <div class="user-box">
                    <input id="age" required="" name="" type="text">
                    <label>Age</label>
                </div>
                <div class="user-box">
                    <input id="mobile" required="" name="" type="text">
                    <label>Mobile No.</label>
                </div>
                <div class="user-box">
                    <input id="password" required="" name="" type="password">
                    <label>Password</label>
                </div>


                <a id="buttonsignup" href="#">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                    Submit
                </a>
            </form>
            <p>Already have an account? <a href="./login.html" class="a2">Sign In!</a></p>
        </div>

        <div class="sideimg">
            <img src="https://media0.giphy.com/media/M9ZMQFPANNm0b9uBhc/giphy.gif?cid=ecf05e47dk40kgatja6u2hn7ficah0brahbep35mr263bi0s&ep=v1_gifs_related&rid=giphy.gif&ct=g"
                alt=""><br><br>
            <button onclick="openBMIForm()" class="somesignup">Check Your BMI</button>
        </div>


        <div class="module" id="cart-module">
            <span></span>
            <span class="module-close" onclick="closeModule()">&times;</span>
        </div>

        <div id="bmi-form" style="display:none;">
            <form>
                <input type="number" placeholder="WEIGHT" id="weight" name="weight" required><br>

                <!-- <label id="heightform" for="height">Height (cm):</label> -->
                <input type="number" placeholder="HEIGHT" id="height" name="height" required><br>

                <button type="button" class="btnforopen1" onclick="calculateBMI()">Calculate</button>
                <button type="button" class="btnforopen2" onclick="closeBMIForm()">Close</button>

                <p class="bmishow">Your BMI is: <span id="bmi-result"></span></p>
            </form>
        </div>

    </div>
</body>

</html>

<script>

    function openBMIForm() {
        document.getElementById("bmi-form").style.display = "block";
    }

    function closeBMIForm() {
        document.getElementById("bmi-form").style.display = "none";
    }

    function calculateBMI() {
        const weight = document.getElementById("weight").value;
        const height = document.getElementById("height").value / 100;
        const bmi = weight / (height * height);
        if (bmi < 18.5) {
            document.getElementById("bmi-result").textContent = bmi.toFixed(1) + " (Underweight)"
            document.getElementById("bmi-result").style.color = "red";
        }
        else if (bmi >= 18.5 && bmi < 25) {
            document.getElementById("bmi-result").textContent = bmi.toFixed(1) + " (Normal)";
            document.getElementById("bmi-result").style.color = "green";
        }
        else if (bmi >= 25 && bmi < 30) {
            document.getElementById("bmi-result").textContent = bmi.toFixed(1) + " (Overweight)";
            document.getElementById("bmi-result").style.color = "orange";
        }
        else if (bmi >= 30) {
            document.getElementById("bmi-result").textContent = bmi.toFixed(1) + " (Obese)";
            document.getElementById("bmi-result").style.color = "red";
        } else {
            document.getElementById("bmi-result").textContent = bmi.toFixed(1);
            document.getElementById("bmi-result").style.color = "black";
        }
    }




    //  Sign up process 

    let buttonsignup = document.getElementById("buttonsignup");

    let Username = document.getElementById("Username");
    let email = document.getElementById("email");
    let age = document.getElementById("age");
    let mobile = document.getElementById("mobile");
    let password = document.getElementById("password");

    let alertempty = document.getElementById("alertempty")
    buttonsignup.addEventListener("click", function () {

        if (Username.value == "" || email.value == "" || age.value == "" || mobile.value == "" || password.value == "") {
            alertempty.innerText = "Fill all details first"

            const module = document.getElementById('cart-module');
            module.innerText = "Fill all details first"
            module.style.display = 'block';
            module.style.borderRadius = '20px';
            module.style.backgroundColor = "red";

            setTimeout(() => {
                alertempty.innerText = ""
                module.style.display = 'none';
            }, 3000);
            return;
        }

        let payload = {
            username: Username.value,
            email: email.value,
            age: age.value,
            mobile: mobile.value,
            password: password.value
        }
        console.log(payload);

        fetch("http://localhost:4000/users/signup", {
            method: "POST",
            body: JSON.stringify(payload),
            headers: {
                "Content-Type": "application/json"
            }
        }).then((res) => {
            return res.json();
        }).then((data) => {
            console.log(data);
            if (data.msg == "otp send to email please verify") {
                window.location.href = "./otp.html"
            } else {
                const module = document.getElementById('cart-module');
                module.innerText = "Something went wrong !!"
                module.style.display = 'block';
                module.style.borderRadius = '20px';
                module.style.backgroundColor = "red";

                setTimeout(() => {
                    module.style.display = 'none';
                }, 3000);
            }

        }).catch((err) => {
            console.log(err);
        })

    });



</script>